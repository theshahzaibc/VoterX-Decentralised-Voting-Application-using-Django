<!DOCTYPE html>
<html>
<head>
    <title>VoteX</title>
</head>
<body>
    <h1>VoteX</h1>
    <div>
        <h2>Register Voter</h2>
        <input type="text" id="voter-address" placeholder="Voter Address">
        <button onclick="registerVoter()">Register</button>
    </div>
    <div>
        <h2>Start Voting</h2>
        <button onclick="startVoting()">Start Voting</button>
    </div>
    <div>
        <h2>End Voting</h2>
        <button onclick="endVoting()">End Voting</button>
    </div>
    <div>
        <h2>Cast Vote</h2>
        <input type="text" id="voter-address-vote" placeholder="Voter Address">
        <input type="text" id="candidate-id" placeholder="Candidate ID">
        <button onclick="castVote()">Vote</button>
    </div>
    <div>
        <h2>Candidates</h2>
        <button onclick="getCandidates()">Get Candidates</button>
        <ul id="candidate-list"></ul>
    </div>

    <script>
        async function registerVoter() {
            const address = document.getElementById('voter-address').value;
            const response = await fetch('/register_voter/', {
                method: 'POST',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                body: new URLSearchParams({ 'address': address })
            });
            const data = await response.json();
            alert(data.status);
        }

        async function startVoting() {
            const response = await fetch('/start_voting/', { method: 'POST' });
            const data = await response.json();
            alert(data.status);
        }
        async function endVoting() {
            const response = await fetch('/end_voting/', { method: 'POST' });
            const data = await response.json();
            alert(data.status);
        }

        async function castVote() {
            const address = document.getElementById('voter-address-vote').value;
            const candidateId = document.getElementById('candidate-id').value;
            const response = await fetch('/cast_vote/', {
                method: 'POST',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                body: new URLSearchParams({ 'address': address, 'candidate_id': candidateId })
            });
            const data = await response.json();
            alert(data.status);
        }

        async function getCandidates() {
            const response = await fetch('/get_candidates/');
            const candidates = await response.json();
            const candidateList = document.getElementById('candidate-list');
            candidateList.innerHTML = '';
            candidates.forEach(candidate => {
                const li = document.createElement('li');
                li.textContent = `ID: ${candidate.id}, Name: ${candidate.name}, Votes: ${candidate.voteCount}`;
                candidateList.appendChild(li);
            });
        }
    </script>
</body>
</html>
